https://net.cybbh.io/public/networking/latest/index.html

Less learning how to directly defend the network and more of the network at basic level

c 6,005.64
s 42.35
I 2,119.16
Network Fundamentals 
______________________________________________________________________________________________________________________

a hex character is a nibble or 4 bits
2 hex characters is a byte
2 half words are a word
a long word is two words 
a quad word is two long words

Communication happens through encapsulation and decapsulation depending on which layer of the OSI model it is going through
Looking at the graph there are different examples of which layers of the OSI model certain applications work through
Data link sub-layers MAC and LLC 
The destination is sent first over ethernet because when the frames are going through switches it makes it faster, because they don't need a source just a destination

Common Ethertypes controlled by IANA.org:

        0x0800 - IPv4

        0x0806 - ARP

        0x86DD - IPv6

        0x8100 - VLAN Tagging 802.1q

The default value of the IHL is 5. but why? 
20B or 160b because it is broken into words (32b) making it 5
Understand headers and how to read them
Linux 64 Windows 128 Cisco 255 on the TTL
Linux just uses icmp and Windows also uses UDP
1 for icmp, 6 for tcp and, 11 for udp

        Flags                        Frag Offset
0        0        0        |        
Res      DF       MF
On the fragmlentation process the offset will go up by number of 8 bits chunks which is why it's going up by 185 instead of 1480

Don't worry about all that noise wireshark got you baby
IPv4 we got APIPA 169.254.0.0/16

Session layer has SOCKS
or Socket Secure
PPTP is a very old and insecure vpn developed by Microsoft
L2TP Cisco and Microsoft combined to create this
SMB/CIFS is Server Message Block shit
RPC is running commands or system calls over the network

Presentation, the difference between a Villain and a Super Villain
Translation
Formating
Encoding (ASCII,EBCDIC,HEX,BASE64)
Encryption (Symmetric or Asymmetric)
Compression

Application Layer THE BEEFY BOI
FTP gives you a prompt
FTP active, like calling the pizza place and telling them to deliver it
FTP passive, calling the pizza to order it, but you still have to go pick it up

Telnet is an insecure method of getting a shell





Spanning Tree Protocol  
Eliminate single point of failure 
ARP requests can cause a broadcast storm with a bunch of interconnected switches 
One switch directly connected to the router is the root bridge
Setting alternate ports to a blocking state can stop a broadcast storm
There's also a Rapid STP which speeds up the setup process
Cisco versions of STP
Per VLAN Spanning Tree (PVST)
Per VLAN Spannning Tree Plus (PVST+)

Layer 2 Discovery Protocols
Cisco Discovery Protocol (CDP)
Foundry Discovery Protocol (FDP)
Link Layer Discovery Protocol (LLDP)


Dynamic Trunking Protocol
Trunk ports are what connect different VLANS


VLAN Trunking Protocol
Whatever updates are made to the VTP are pushed out to all other VLANs in the VTP domain


Port Security
Modes
 - Shutdown
 - Restrict
 - Protect

Switches separate collision domains
Routers separate broadcast domains
WE ARE NOT MAKING ROUTER CONFIGS
Subnetting is dividing networks
Supernetting is combining networks, trading network bits for host bits
DuckDuckGo.com can subnet for you
The lookup process is based off what is the closest match
RIP, EIGRP (USMC), OSPF (ARMY), BGP (Internet)
Having multiple routers is good for backups and reducing a single point of failure
Some protocols for these are 
Hot Standby Router Protocol (HSRP)
Virtual Router Redundancy Protocol (VRRP)
Gateway Load Balancing Protocol (GLBP)

Administrative Distance
Tells the router how much it should trust the route it is looking at

Metrics
Hop
Bandwith
Delay
Load
Maximum Transmission Units
Reliability
Cost
Policy

Static Routing
Does not send updates
No bandwith used and minimal system resources
Data path is pre-determinied
Time consuming and prone to error in configuring
Administrator must intervene during any network outages
Does not scale well for large growing networks

Dynamic Chad Routing
Only worry about BGP for Exterior Gateway Protocols
Look at the table
Advantages
        -Easier to configure and maintain network
        -Intervention not needed with network outages
        -Scales very well for large networks
Disadvantages
        -Consumes bandwidth and system resources
        -Updates can be intercepted
        -Data path is not pre-determined

IGP and EGP
OSPF, RIPv2, EIGRP, and ISIS can all communicate together through BGP
Distance Vector and Link State

Clients talk from port 68 to 67 when using DHCP

BGP
Road-map of the Internet
Routes traffic between Autonomous System (AS) Number
Advertises IP CIDR address blocks
Establishes Peer relationships
Complicated configuration
Complicated and slow path selection
How does it work?
Advertise a more specific route, like how a /24 is more specific than a /16
Follows shorter route
Hijacking
        1. Illegitimate advertising of addresses
        2. BGP propagates false information
        3. Prupose
                -stealing prefixes
                -monitoring traffic
                -intercept (and possibly modify) Internet traffick
                -'black holing' traffic
                -perform MitM
How to prevent
Ip prefix filtering
BGP hijacking detection
  - Track the change in TTL of incoming packets
  - Incresed round trip time (RTT) which increases latency
  - Monitoring misdirected traffic
BGPSec

Capture library
Using things like Libpcap, WinPcap, or NPCAP


TCPDUMP
sudo tcpdump -i eth0 -XXvvn '(not tcp port 22) && (udp port 68)'
sudo tcpdump -i eth0 -XXvvn 'src host 10.10.0.40 && not tcp port 22'
sudo tcpdump -XXvvnr /home/activity_resources/pcaps/Xtra.pcap

when trying to filter for the DSCP multiply it by 4, which is why  is true
ip[6:2] & 0x1FFF !=0
ip[12:4] is for source ip addresses
ip[16:4] is for destination ip address
ip[12:4]=0x0A0A2801
ip[12:4]&0xFFFFFF00=0x0A0A2800 this works as a subnet mask 


Ipv6 and 4 with ttl less than 64
ip[8]<=64||ip6[7]<=64

Don't fragment bit
ip[6]&0x40 = 0x40

Transport higher than 1024
tcp[0:2]>0x400||udp[0:2]>0x400

all packets with the udp protocol
ip[9]=0x11||ip6[6]=0x11

IP ID field of 213
ip[4:2]=213

Vlan tag
ether[12:2]=0x8100

question DNS
tcp[2:2]=0x40||udp[2:2]=0x40||tcp[0:2]=0x40||udp[0:2]=0x40

initial packet from tcp
tcp[13]=0x02

response packets from servers
tcp[13]=0x12

response packets from a server with closed tcp ports
tcp[13]=0x04

tcp and udp to well known ports
tcp[2:2]<1024||udp[2:2]<1024

HTTP
tcp[0:2]=80||tcp[2:2]=80

telnet traffic
tcp[0:2]=23||tcp[2:2]=23

arp traffic
ether[12:2]=0x0806

Evil bit
ip[6]&0x80=0x80

CHAOS
ip[9]=0x10

DSCP field of 37
ip[1]&0xFC=0x94

Traceroutes
ip[8]=1&&(ip[9]=0x11||ip[9]=0x01)

URG flag not set and pointer has a value
tcp[13]&0x20=0&&tcp[18:2]>0

TCP null scan to host 10.10.10.10
tcp[13]=0&&ip[16:4]=0x0A0A0A0A0A

Vlan hopper
ether[12:4]&0xffff0fff=0x81000001&&ether[16:4]&0xffff0fff=0x8100000a







Network Programming 
______________________________________________________________________________________________________________________

